/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","./Label","./StepInput","./DateTimePicker","sap/ui/unified/Calendar","sap/ui/unified/DateRange","sap/ui/unified/calendar/MonthPicker","sap/ui/unified/calendar/CustomMonthPicker"],function(e,t,a,r,n,o,i,s){"use strict";var u=e.extend("sap.m.DynamicDateOption",{metadata:{library:"sap.m",properties:{key:{type:"string"},valueTypes:{type:"string[]",multiple:true}}}});u.prototype.getText=function(e){return this.getKey()};u.prototype.getValueHelpUITypes=function(e){throw new Error("Need implementation for method getValueHelpUITypes. Option: "+this.getKey())};u.prototype.createValueHelpUI=function(e,a){var r=e.getValue()&&Object.assign({},e.getValue()),n=this.getValueHelpUITypes(e),o=n.length,i=[],s;if(!e.aControlsByParameters){e.aControlsByParameters={}}e.aControlsByParameters[this.getKey()]=[];if(r&&r.values){r.values=r.values.map(function(t){if(t instanceof Date){return e._reverseConvertDate(t)}return t})}for(var u=0;u<n.length;u++){if(n[u].getText()){i.push(new t({text:n[u].getText(),width:"100%"}))}s=this._createControl(u,n[u].getType(),r,a,o);i.push(s);e.aControlsByParameters[this.getKey()].push(s)}return i};u.prototype.validateValueHelpUI=function(e){var t=this.getValueHelpUITypes();for(var a=0;a<t.length;a++){var r=e.aControlsByParameters[this.getKey()][a];switch(t[a].getType()){case"int":if(r._isLessThanMin(r.getValue())||r._isMoreThanMax(r.getValue())){return false}break;case"month":case"custommonth":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"datetime":if(!r.getDateValue()){return false}break}}return true};u.prototype.getValueHelpOutput=function(e){var t=this.getValueHelpUITypes(),a={},r;a.operator=this.getKey();a.values=[];for(var n=0;n<t.length;n++){var o=e.aControlsByParameters[this.getKey()][n];switch(t[n].getType()){case"int":r=o.getValue();break;case"month":case"date":if(!o.getSelectedDates().length){return null}r=o.getSelectedDates()[0].getStartDate();break;case"custommonth":if(!o.getSelectedDates()||!o.getSelectedDates().length){return null}r=[o.getSelectedDates()[0].getStartDate().getMonth(),o.getSelectedDates()[0].getStartDate().getFullYear()];break;case"datetime":if(!o.getDateValue()){return null}r=o.getDateValue();break;case"daterange":if(!o.getSelectedDates().length){return null}var i=o.getSelectedDates()[0].getEndDate()||o.getSelectedDates()[0].getStartDate();r=[o.getSelectedDates()[0].getStartDate(),i];break;default:break}if(Array.isArray(r)){a.values=Array.prototype.concat.apply(a.values,r)}else{r&&a.values.push(r)}}return a};u.prototype.getGroup=function(){return 0};u.prototype.getGroupHeader=function(){var e=this.getGroup()>-1&&this.getGroup()<7?this.getGroup():0;return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_"+e)};u.prototype.format=function(e){throw new Error("Need implementation for method format. Option: "+this.getKey())};u.prototype.parse=function(e){throw new Error("Need implementation for method parse. Option: "+this.getKey())};u.prototype.toDates=function(e){throw new Error("Need implementation for method toDates. Option: "+this.getKey())};u.prototype.enhanceFormattedValue=function(){return false};u.prototype._createControl=function(e,t,a,r,n){var o;switch(t){case"int":o=this._createIntegerControl(a,e,r);break;case"date":o=this._createDateControl(a,e,r);break;case"datetime":if(n===1){o=this._createDateTimeInnerControl(a,e,r)}else if(n===2){o=this._createDateTimeControl(a,e,r)}break;case"daterange":o=this._createDateRangeControl(a,e,r);break;case"month":o=this._createMonthControl(a,e,r);break;case"custommonth":o=this._createCustomMonthControl(a,e,r);break;default:break}return o};u.prototype._createIntegerControl=function(e,t,r){var n=new a({width:"120px"});if(e&&this.getKey()===e.operator){n.setValue(e.values[t])}if(r instanceof Function){n.attachChange(function(){r(this)},this)}return n};u.prototype._createDateTimeControl=function(e,t,a){var n=new r;if(e&&this.getKey()===e.operator){n.setDateValue(e.values[t])}if(a instanceof Function){n.attachChange(function(){a(this)},this)}return n};u.prototype._createDateControl=function(e,t,a){var r=new n({width:"100%"});if(e&&this.getKey()===e.operator){r.addSelectedDate(new o({startDate:e.values[t]}))}if(a instanceof Function){r.attachSelect(function(){a(this)},this)}return r};u.prototype._createDateTimeInnerControl=function(e,t,a){var n=new r({width:"100%"}),i;n._createPopup();n._createPopupContent();i=n._oPopupContent;i.setForcePhoneView(true);i.getCalendar().removeAllSelectedDates();if(e&&this.getKey()===e.operator){var s=new Date(e.values[t]);i.getCalendar().addSelectedDate(new o({startDate:s}));i.getClocks()._setTimeValues(s)}if(a instanceof Function){i.getClocks().getAggregation("_clocks").forEach(function(e){e.attachChange(function(e){a(this)}.bind(this))}.bind(this));if(i.getClocks().getAggregation("_buttonAmPm")){i.getClocks().getAggregation("_buttonAmPm").attachSelectionChange(function(e){a(this)}.bind(this))}i.getCalendar().attachSelect(function(){a(this)},this)}return i};u.prototype._createDateRangeControl=function(e,t,a){var r=new n({intervalSelection:true,width:"100%"});if(e&&this.getKey()===e.operator){r.addSelectedDate(new o({startDate:e.values[t],endDate:e.values[t+1]}))}if(a instanceof Function){r.attachSelect(function(){a(this)},this)}return r};u.prototype._createMonthControl=function(e,t,a){var r=new i,n=new Date,s=e&&this.getKey()===e.operator?e.values[t]:n.getMonth();r.setMonth(s);r.addSelectedDate(new o({startDate:n}));if(a instanceof Function){r.attachSelect(function(){a(this)},this)}return r};u.prototype._createCustomMonthControl=function(e,t,a){var r=new s,n=new Date,i=e&&t>=0&&this.getKey()===e.operator?e.values[t]:n.getMonth(),u=e&&t>=0&&this.getKey()===e.operator?e.values[t+1]:n.getFullYear();n.setDate(1);n.setMonth(i);n.setYear(u);r.addSelectedDate(new o({startDate:n}));if(a instanceof Function){r.attachSelect(function(){a(this)},this)}return r};return u});