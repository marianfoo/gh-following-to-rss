/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage"],function(t,a,e,r){"use strict";var n={};var i="";var o=parseFloat(t.BaseFontSize);n.measureText=function(){var t=.05;var r=document.createElement("canvas").getContext("2d");var n=function(){i=[parseFloat(e.get({name:"sapMFontMediumSize"})||"0.875rem")*o+"px",e.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return i};a.attachThemeChanged(n);return function(a,e){r.font=e||i||n();return r.measureText(a||"").width/o+t}}();n.calcTypeWidth=function(){var t=0;var e=[2023,9,26,22,47,58,999];var r=new Date(Date.UTC.apply(0,e));var i=new(Function.prototype.bind.apply(Date,[null].concat(e)));var o={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};a.attachThemeChanged(function(){t=0});return function(e,u){var m=e.getMetadata().getName().split(".").pop();var s=u&&u.maxWidth||19;var l=u&&u.gap||0;var h=function(t){return Math.min(t+l,s)};if(m=="Boolean"){if(!t){var c=a.getLibraryResourceBundle("sap.ui.core");var d=n.measureText(c.getText("YES"));var g=n.measureText(c.getText("NO"));t=Math.max(d,g)}return h(t)}if(m=="String"||e.isA("sap.ui.model.odata.type.String")){var p=parseInt(e.getConstraints().maxLength)||0;if(!p||p*.25>s){return s}var v=n.measureText("A".repeat(p));if(p<s||s<10){return Math.min(v,s)}var f=Math.log(v-s*.16)/Math.log(s/3)*(s/2)*Math.pow(s/19,1/v);return h(Math.min(f,v))}if(m.startsWith("Date")||m.startsWith("Time")){var M=e.getFormatOptions();var T=M.UTC?r:i;var x=T.toLocaleDateString();if(m=="TimeOfDay"){x=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(T);x=e.formatValue(x,"string")}else if(e.isA("sap.ui.model.odata.type.Time")){x=e.formatValue({__edmType:"Edm.Time",ms:r.valueOf()},"string")}else{x=e.formatValue(M.interval?[T,new Date(T*1.009)]:T,"string");(e.oFormat&&e.oFormat.oFormatOptions&&e.oFormat.oFormatOptions.pattern||"").replace(/[MELVec]{3,4}/,function(t){x+=t.length==4?"---":"-"})}return h(n.measureText(x))}if(o[m]){var y=parseInt(e.getConstraints().scale)||0;var W=parseInt(e.getConstraints().precision)||20;W=Math.min(W,o[m]);var C=2*Math.pow(10,W-y-1);C=e.formatValue(C,"string");return h(n.measureText(C))}return u&&u.defaultWidth||8}}();n.calcHeaderWidth=function(){var t="";var r=function(){if(!t){t=[e.get({name:"sapUiColumnHeaderFontWeight"})||"normal",i].join(" ")}return t};a.attachThemeChanged(function(){t=""});return function(t,a,e,i){var o=t.length;e=e||19;i=i||2;if(a>e){return e}if(i>o){return i}a=Math.max(a,i);if(a>o){return a}var u=n.measureText(t,r());u=Math.min(u,e*.7);var m=Math.max(1,1-Math.log(Math.max(a-1.7,.2))/Math.log(e*.5)+1);var s=m*a;var l=Math.max(0,u-s);var h=l<.15?u:s+l*(1-1/a)/Math.E;return h}}();n.calcColumnWidth=function(t,a,e){if(!Array.isArray(t)){t=[t]}e=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,padding:1,gap:0,verticalArrangement:false},e);var r=0;var i=Math.max(1,e.minWidth);var o=Math.max(i,e.maxWidth);var u=e.gap+t.reduce(function(t,a){var r=a,i={defaultWidth:e.defaultWidth,maxWidth:e.maxWidth};if(Array.isArray(a)){r=a[0];i=a[1]||i}var o=n.calcTypeWidth(r,i);return e.verticalArrangement?Math.max(t,o):t+o+(t&&.5)},0);if(a){r=n.calcHeaderWidth(a,u,o,i)}u=Math.max(i,u,r);u=Math.min(u,o);u=Math.round(u*100)/100;return u+e.padding+"rem"};n.getNoColumnsIllustratedMessage=function(){var e=a.getLibraryResourceBundle("sap.m");return new r({illustrationType:t.IllustratedMessageType.AddColumn,title:e.getText("TABLE_NO_COLUMNS_TITLE"),description:e.getText("TABLE_NO_COLUMNS_DESCRIPTION")})};return n});