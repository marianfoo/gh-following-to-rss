/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/base/Log","sap/base/util/each","sap/base/util/isEmptyObject","sap/base/util/isPlainObject","../Plugin","../Support","../ToolsAPI","sap/base/security/encodeXML"],function(e,t,o,i,a,r,s,n,u){"use strict";var p=r.extend("sap.ui.core.support.plugins.TechInfo",{constructor:function(e){r.apply(this,["sapUiSupportTechInfo","Technical Information",e]);this._aEventIds=this.runsAsToolPlugin()?[this.getId()+"Data",this.getId()+"FinishedE2ETrace"]:[this.getId()+"ToggleDebug",this.getId()+"SetReboot",this.getId()+"Refresh",this.getId()+"StartE2ETrace",this.getId()+"ToggleStatistics"];if(this.runsAsToolPlugin()){this.e2eLogLevel="medium";this.e2eTraceStarted=false}}});p.prototype.onsapUiSupportTechInfoData=function(e){var t=this;var a=e.getParameter("data");a.modules.sort();this.e2eTraceStarted=a["e2e-trace"].isStarted;var r=["<div class='sapUiSupportToolbar'>","<button id='",t.getId(),"-Refresh' class='sapUiSupportRoundedButton'>Refresh</button>","<div><div class='sapUiSupportTechInfoCntnt'>","<table border='0' cellpadding='3' class='infoTable'>"];function n(e,t){var o=[];if(e){var i=/^(\d{4})(\d{2})(\d{2})-?(\d{2})(\d{2})$/.exec(e);if(i){e=i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]}o.push("built at "+l(e))}if(t){o.push("last change "+l(t))}return o.length===0?"":" ("+o.join(", ")+")"}var u="SAPUI5";var p="not available";try{var c=sap.ui.getVersionInfo();u=c.name;p="<a href='"+sap.ui.resource("","sap-ui-version.json")+"' target='_blank' class='sapUiSupportLink' title='Open Version Info'>"+l(c.version)+"</a>"+n(c.buildTimestamp,c.scmRevision)}catch(e){}d(r,true,true,u,function(e){e.push(p)});if(!/openui5/i.test(u)){d(r,true,true,"OpenUI5 Version",function(e){e.push(l(a.version)+n(a.build,a.change))})}d(r,true,true,"Loaded jQuery Version",function(e){return a.jquery});d(r,true,true,"User Agent",function(e){return a.useragent+(a.docmode?", Document Mode '"+a.docmode+"'":"")});d(r,true,true,"Debug Sources",function(e){e.push(a.debug?"ON":"OFF","<a href='#' id='",t.getId(),"-tggleDbgSrc' class='sapUiSupportLink'>Toggle</a>")});d(r,true,true,"Application",a.appurl);f(r,true,true,"Configuration (bootstrap)",a.bootconfig);f(r,true,true,"Configuration (computed)",a.config);if(!i(a.libraries)){f(r,true,true,"Libraries",a.libraries)}f(r,true,true,"Loaded Libraries",a.loadedLibraries);d(r,true,true,"Loaded Modules",function(e){o(a.modules,function(t,o){if(o.indexOf("sap.ui.core.support")<0){e.push("<span>",l(o),"</span>");if(t<a.modules.length-1){e.push(", ")}}})});f(r,true,true,"URI Parameters",a.uriparams);d(r,true,true,"E2E Trace",function(e){e.push("<label class='sapUiSupportLabel'>Trace Level:</label>","<select id='",t.getId(),"-logLevelE2ETrace' class='sapUiSupportTxtFld sapUiSupportSelect'>","<option value='low'"+(t.e2eLogLevel==="low"?" selected":"")+">LOW</option>","<option value='medium'"+(t.e2eLogLevel==="medium"?" selected":"")+">MEDIUM</option>","<option value='high'"+(t.e2eLogLevel==="hight"?" selected":"")+">HIGH</option>","</select>");e.push("<button id='"+t.getId()+"-startE2ETrace' class='sapUiSupportRoundedButton "+(a["e2e-trace"].isStarted?" active":"")+"'>"+(a["e2e-trace"].isStarted?"Running...":"Start")+"</button>");e.push("<div class='sapUiSupportTechInfoXMLOutput'>");e.push("<label class='sapUiSupportLabel'>XML Output:</label>");e.push("<textarea id='"+t.getId()+"-outputE2ETrace'></textarea>");e.push("</div>")});r.push("</table></div>");this.$().html(r.join(""));this.$("tggleDbgSrc").on("click",function(e){e.preventDefault();s.getStub().sendEvent(t.getId()+"ToggleDebug",{})});this.$("Refresh").on("click",function(e){e.preventDefault();s.getStub().sendEvent(t.getId()+"Refresh",{})});this.$("outputE2ETrace").on("click",function(){this.focus();this.select()});this.$("startE2ETrace").on("click",function(){if(!t.e2eTraceStarted){t.e2eLogLevel=t.$("logLevelE2ETrace").val();t.$("startE2ETrace").addClass("active").text("Running...");t.$("outputE2ETrace").text("");s.getStub().sendEvent(t.getId()+"StartE2ETrace",{level:t.e2eLogLevel});t.e2eTraceStarted=true}});document.title="UI5 Diagnostics - "+a.title};p.prototype.onsapUiSupportTechInfoToggleDebug=function(t){e.sap.debug(!e.sap.debug());c(this)};p.prototype.onsapUiSupportTechInfoSetReboot=function(t){e.sap.setReboot(t.getParameter("rebootUrl"))};p.prototype.onsapUiSupportTechInfoStartE2ETrace=function(e){var o=this,i=e.getParameter("level");sap.ui.require(["sap/ui/core/support/trace/E2eTraceLib"],function(e){e.start(i,function(e){s.getStub().sendEvent(o.getId()+"FinishedE2ETrace",{trace:e})})},function(e){t.error("Could not load module 'sap/ui/core/support/trace/E2eTraceLib':",e)})};p.prototype.onsapUiSupportTechInfoFinishedE2ETrace=function(e){this.$("startE2ETrace").removeClass("active").text("Start");this.$("outputE2ETrace").text(e.getParameter("trace"));this.e2eTraceStarted=false};p.prototype.onsapUiSupportTechInfoRefresh=function(e){c(this)};p.prototype.onsapUiSupportTechInfoToggleStatistics=function(t){e.sap.statistics(!e.sap.statistics());c(this)};p.prototype.init=function(e){r.prototype.init.apply(this,arguments);if(!this.runsAsToolPlugin()){c(this);return}this.$().html("No Information available")};function c(e){var t=n.getFrameworkInformation();var o={version:t.commonInformation.version,build:t.commonInformation.buildTime,change:t.commonInformation.lastChange,jquery:t.commonInformation.jquery,useragent:t.commonInformation.userAgent,docmode:t.commonInformation.documentMode,debug:t.commonInformation.debugMode,bootconfig:t.configurationBootstrap,config:t.configurationComputed,libraries:t.libraries,loadedLibraries:t.loadedLibraries,modules:t.loadedModules,uriparams:t.URLParameters,appurl:t.commonInformation.applicationHREF,title:t.commonInformation.documentTitle,statistics:t.commonInformation.statistics};var i=sap.ui.require("sap/ui/core/support/trace/E2eTraceLib");o["e2e-trace"]={isStarted:i?i.isStarted():false};s.getStub().sendEvent(e.getId()+"Data",{data:o})}function l(e){return e==null?"":u(String(e))}function d(e,t,o,i,a){e.push("<tr><td ",t?"align='right' ":"","valign='top'>","<label class='sapUiSupportLabel'>",l(i),"</label></td><td",o?" class='sapUiSupportTechInfoBorder'":"",">");var r=a;if(typeof a==="function"){r=a(e)}e.push(l(r));e.push("</td></tr>")}function f(t,o,i,r,s){d(t,o,i,r,function(t){t.push("<table border='0' cellspacing='0' cellpadding='3'>");e.each(s,function(e,o){var i="";if(o){if(typeof o==="string"||typeof o==="string"||typeof o==="boolean"){i=o}else if(Array.isArray(o)||a(o)){i=JSON.stringify(o)}}d(t,false,false,e,""+i)});t.push("</table>")})}return p});