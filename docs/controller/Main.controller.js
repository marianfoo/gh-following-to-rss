sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageBox","@octokit/core","githubfollower/lib/firebase"],function(t,e,o,n,l){function i(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const a=i(t);const s=n["Octokit"];const r=l["initializeApp"];const u=l["getAuth"];const d=l["GithubAuthProvider"];const h=l["signInWithPopup"];const p=a.extend("de.marianzeis.githubfollower.controller.Main",{onInit:function t(){const o={apiKey:"AIzaSyCy1d13pYC79sOgUZnn4-sJ5VM9QY6TjqM",authDomain:"github-followers-281ea.firebaseapp.com",projectId:"github-followers-281ea",storageBucket:"github-followers-281ea.appspot.com",messagingSenderId:"576057379323",appId:"1:576057379323:web:4fb59feea548cdefa1235e"};this.app=r(o);this.auth=u(this.app);this.provider=new d;this.provider.setCustomParameters({allow_signup:"false"});this.token="";this.getView().setModel(new e({token:"",busyOPMLButton:false}),"data")},signInToGitHub:function t(){this.githubSignInPopup(this.provider)},createAndDownloadOPMLFile:async function t(){this.getModel("data").setProperty("/busyOPMLButton",true);let e=1;let n=[];let l=[];const i=new s({auth:this.token});const a=await i.request("GET /user/followers");n=a.data;let r=await i.request("GET /user/following");l=r.data;while(r.data.length>=30){e+=1;r=await i.request("GET /user/following",{page:e});l=[...l,...r.data]}this.opml(l);this.getModel("data").setProperty("/busyOPMLButton",false);o.success("Your OPML file is ready!")},opml:function t(e){let o=[];var n={title:"title-text",dateCreated:new Date(2014,2,9),ownerName:"azu"};for(var l=0;l<e.length;l++){o.push({text:e[l].login,title:e[l].login,type:"rss",xmlUrl:e[l].html_url+".atom",htmlUrl:e[l].html_url})}let i="<head><title>Sample OPML file for RSSReader</title></head>";let a=[];for(let t=0;t<o.length;t++){let e='<outline text="'+o[t].text+'" title="'+o[t].title+'" type="'+o[t].type+'" xmlUrl="'+o[t].xmlUrl+'" htmlUrl="'+o[t].htmlUrl+'" />';a.push(e)}let s='<?xml version="1.0" encoding="UTF-8"?><opml version="2.0">'+i+"<body>"+a+"</body>"+"</opml>";this.downloadFile("opml.xml",s)},githubSignInPopup:function t(e){const o=u();h(o,e).then(t=>{this.token=t._tokenResponse.oauthAccessToken;this.getModel("data").setProperty("/token",this.token)}).catch(t=>{var e=t.code;var o=t.message;var n=t.email;var l=t.credential})},downloadFile:function t(e,o){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o));n.setAttribute("download",e);n.style.display="none";document.body.appendChild(n);n.click();document.body.removeChild(n)}});return p});