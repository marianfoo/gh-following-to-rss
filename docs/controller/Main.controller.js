sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageBox"],function(e,t,o){function a(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const l=a(e);const i=l.extend("de.marianzeis.githubfollower.controller.Main",{onInit:function e(){const o={apiKey:"AIzaSyCy1d13pYC79sOgUZnn4-sJ5VM9QY6TjqM",authDomain:"github-followers-281ea.firebaseapp.com",projectId:"github-followers-281ea",storageBucket:"github-followers-281ea.appspot.com",messagingSenderId:"576057379323",appId:"1:576057379323:web:4fb59feea548cdefa1235e"};this.app=firebase.initializeApp(o);this.auth=firebase.auth(this.app);this.provider=new firebase.auth.GithubAuthProvider;this.provider.setCustomParameters({allow_signup:"false"});this.token="";this.getView().setModel(new t({token:"",busyOPMLButton:false}),"data")},signInToGitHub:function e(){this.githubSignInPopup(this.provider)},createAndDownloadOPMLFile:async function e(){this.getModel("data").setProperty("/busyOPMLButton",true);let t=1;let a=[];let l=[];const i=new Octokit({auth:this.token});const n=await i.request("GET /user/followers");a=n.data;let s=await i.request("GET /user/following");l=s.data;while(s.data.length>=30){t+=1;s=await i.request("GET /user/following",{page:t});l=[...l,...s.data]}this.opml(l);this.getModel("data").setProperty("/busyOPMLButton",false);o.success("Your OPML file is ready!")},opml:function e(t){let o=[];var a={title:"title-text",dateCreated:new Date(2014,2,9),ownerName:"azu"};for(var l=0;l<t.length;l++){o.push({text:t[l].login,title:t[l].login,type:"rss",xmlUrl:t[l].html_url+".atom",htmlUrl:t[l].html_url})}let i="<head><title>Sample OPML file for RSSReader</title></head>";let n=[];for(let e=0;e<o.length;e++){let t='<outline text="'+o[e].text+'" title="'+o[e].title+'" type="'+o[e].type+'" xmlUrl="'+o[e].xmlUrl+'" htmlUrl="'+o[e].htmlUrl+'" />';n.push(t)}let s='<?xml version="1.0" encoding="UTF-8"?><opml version="2.0">'+i+"<body>"+n+"</body>"+"</opml>";this.downloadFile("opml.xml",s)},githubSignInPopup:function e(t){firebase.auth().signInWithPopup(t).then(e=>{var t=e.credential;var o=t.accessToken;this.token=o;this.getModel("data").setProperty("/token",o);var a=e.user}).catch(e=>{var t=e.code;var o=e.message;var a=e.email;var l=e.credential})},downloadFile:function e(t,o){var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o));a.setAttribute("download",t);a.style.display="none";document.body.appendChild(a);a.click();document.body.removeChild(a)}});return i});